pipeline {
    agent any
    environment {
        // Reference to the Maven tool configured in Jenkins
        MAVEN_HOME = tool name: 'Maven3' // Ensure Maven is correctly installed and configured in Jenkins
    }
    stages {
        stage('Build') {
            steps {
                script {
                    // Debug Maven version and path
                    sh "${MAVEN_HOME}/bin/mvn -v"
                    // Print current directory
                    sh 'pwd'
                    // List files in the workspace
                    sh 'ls -al'
                }
                // Run Maven build
                sh "${MAVEN_HOME}/bin/mvn -B -DskipTests clean package"
            }
        }
        stage('Test') {
            steps {
                sh "${MAVEN_HOME}/bin/mvn test"
            }
            post {
                always {
                    junit 'target/surefire-reports/*.xml'
                }
            }
        }
     stage('Deliver') {
    steps {
        script {
            // Print the current directory for debugging
            sh 'pwd'
            // List files in the scripts directory
            sh 'ls -al ./jenkins/scripts/'
            // Check if deliver.sh is executable
            sh 'ls -l ./jenkins/scripts/deliver.sh'
            // Print the contents of the deliver.sh script for debugging
            sh 'cat ./jenkins/scripts/deliver.sh'
        }
        // Run the deliver script
        sh './jenkins/scripts/deliver.sh'
    }
    post {
        success {
            echo 'Build, Test, and Delivery were successful!'
        }
        failure {
            echo 'Build failed. Check the logs for more details.'
        }
    }
}
    }
}
